rule BrazilianBankerDownloader  
{
meta:
	author = "Gustavo Palazolo"
	date = "03-26-2018"
	description = "Brazilian Banking Downloader"

strings:
	$a0 = "AutoIt3ExecuteScript" ascii wide nocase
	$a1 = "AutoIt3ExecuteLine" ascii wide nocase
	$a2 = "AutoIt3OutputDebug" ascii wide nocase
	$a3 = "ErrorStdOut" ascii wide nocase

	$w0 = "VirtualAlloc" ascii wide nocase
	$w1 = "LockWindowUpdate" ascii wide nocase
	$w2 = "GetMessageW" ascii wide nocase
	$w3 = "BlockInput" ascii wide nocase
	$w4 = "OpenClipboard" ascii wide nocase
	$w5 = "IsClipboardFormatAvailable" ascii wide nocase
	$w6 = "GetClipboardData" ascii wide nocase
	$w7 = "CloseClipboard" ascii wide nocase
	$w8 = "CountClipboardFormats" ascii wide nocase
	$w9 = "EmptyClipboard" ascii wide nocase
	$w10 = "SetClipboardData" ascii wide nocase
	$w11 = "SetRect" ascii wide nocase
	$w12 = "AdjustWindowRectEx" ascii wide nocase
	$w13 = "CopyImage" ascii wide nocase
	$w14 = "SetWindowPos" ascii wide nocase
	$w15 = "GetCursorInfo" ascii wide nocase
	$w16 = "RegisterHotKey" ascii wide nocase
	$w17 = "ClientToScreen" ascii wide nocase
	$w18 = "GetKeyboardLayoutNameW" ascii wide nocase
	$w19 = "IsCharAlphaW" ascii wide nocase
	$w20 = "IsCharAlphaNumericW" ascii wide nocase
	$w21 = "IsCharLowerW" ascii wide nocase
	$w22 = "IsCharUpperW" ascii wide nocase
	$w23 = "GetMenuStringW" ascii wide nocase
	$w24 = "GetCaretPos" ascii wide nocase
	$w25 = "IsZoomed" ascii wide nocase
	$w26 = "MonitorFromPoint" ascii wide nocase
	$w27 = "GetMonitorInfoW" ascii wide nocase
	$w28 = "SetWindowLongW" ascii wide nocase
	$w29 = "SetLayeredWindowAttributes" ascii wide nocase
	$w30 = "FlashWindow" ascii wide nocase
	$w31 = "GetClassLongW" ascii wide nocase
	$w32 = "TranslateAcceleratorW" ascii wide nocase
	$w33 = "IsDialogMessageW" ascii wide nocase
	$w34 = "CreateMenu" ascii wide nocase
	$w35 = "IsDlgButtonChecked" ascii wide nocase
	$w36 = "DefDlgProcW" ascii wide nocase
	$w37 = "CallWindowProcW" ascii wide nocase
	$w38 = "ReleaseCapture" ascii wide nocase
	$w39 = "SetCapture" ascii wide nocase
	$w40 = "USER32.dll" ascii wide nocase
	$w41 = "RoundRect" ascii wide nocase
	$w42 = "SetBkMode" ascii wide nocase
	$w43 = "GetObjectW" ascii wide nocase
	$w44 = "RegCreateKeyExW" ascii wide nocase
	$w45 = "RegSetValueExW" ascii wide nocase
	$w46 = "RegEnumKeyExW" ascii wide nocase
	$w47 = "RegDeleteKeyW" ascii wide nocase
	$w48 = "RegDeleteValueW" ascii wide nocase
	$w49 = "RegEnumValueW" ascii wide nocase

	$m0 = {6D 00 6D 00 6D 00 6D 00 6D 00 6D 00 6D 00 6D 00 6D}
	$m1 = {67 02 67 02 67 02 67 02 67 02 67 02 67 02 67 02 67 02}
	$m2 = {6A 02 6A 02 6A 02 6A 02 6A 02 6A 02 6A 02 6A 02 6A}

condition:
	all of ($a*) and all of ($w*) and all of ($m*)
}
